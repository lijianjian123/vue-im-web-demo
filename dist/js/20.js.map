{"version":3,"sources":["webpack:///./src/pages/old/ChatHistory.vue?e96a","webpack:///./src/pages/old/ChatHistory.vue","webpack:///./src/pages/old/ChatHistory.vue?2642","webpack:///./src/pages/old/ChatHistory.vue?2d52","webpack:///./src/pages/old/ChatHistory.vue?5d04"],"names":["beforeMount","$store","state","isRefresh","location","href","sessionId","mounted","dispatch","getHistoryMsgs","updated","tempPagePos","pageUtil","getChatListHeight","scrollChatListDown","currPagePos","components","ChatList","data","leftBtnOptions","backText","preventGoBack","computed","$route","params","sessionName","user","test","replace","userUID","isRobot","robotInfos","nick","userInfo","userInfos","util","getFriendAlias","myInfo","msglist","msgs","currSessionMsgs","scene","parseSession","to","canLoadMore","noMoreHistoryMsgs","methods","loadMore","getChatListScroll","onClickBack","window","history","go"],"mappings":"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","file":"20.js","sourcesContent":["\n/* styles */\nrequire(\"!!vue-style-loader!css-loader?sourceMap!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"id\\\":\\\"data-v-13013b22\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":true}!../../../node_modules/vux-loader/src/style-loader.js!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./ChatHistory.vue\")\n\nvar Component = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../../node_modules/vux-loader/src/script-loader.js!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./ChatHistory.vue\"),\n  /* template */\n  require(\"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-13013b22\\\"}!../../../node_modules/vux-loader/src/before-template-compiler-loader.js!../../../node_modules/vux-loader/src/template-loader.js!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./ChatHistory.vue\"),\n  /* scopeId */\n  \"data-v-13013b22\",\n  /* cssModules */\n  null\n)\nComponent.options.__file = \"/Users/wangxudong/me/sayabc/vue-im-web-demo/src/pages/old/ChatHistory.vue\"\nif (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== \"default\" && key !== \"__esModule\"})) {console.error(\"named exports are not supported in *.vue files.\")}\nif (Component.options.functional) {console.error(\"[vue-loader] ChatHistory.vue: functional components are not supported with templates, they should use render functions.\")}\n\n/* hot reload */\nif (module.hot) {(function () {\n  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), false)\n  if (!hotAPI.compatible) return\n  module.hot.accept()\n  if (!module.hot.data) {\n    hotAPI.createRecord(\"data-v-13013b22\", Component.options)\n  } else {\n    hotAPI.reload(\"data-v-13013b22\", Component.options)\n  }\n})()}\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/old/ChatHistory.vue\n// module id = 332\n// module chunks = 20","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport ChatList from './components/ChatList'\nimport util from '../utils'\nimport pageUtil from '../utils/page'\n\nexport default {\n  beforeMount () {\n    // 如果是刷新页面，重定向至聊天页面\n    if (this.$store.state.isRefresh) {\n      location.href = `#/chat/${this.sessionId}`\n    }\n  },\n  mounted () {\n    this.$store.dispatch('resetNoMoreHistoryMsgs')\n    this.getHistoryMsgs()\n  },\n  updated () {\n    let tempPagePos = pageUtil.getChatListHeight()\n    pageUtil.scrollChatListDown(tempPagePos - this.currPagePos)\n    this.currPagePos = tempPagePos\n  },\n  components: {\n    ChatList\n  },\n  data () {\n    return {\n      leftBtnOptions: {\n        backText: ' ',\n        preventGoBack: true,\n      },\n      currPagePos: 0,\n      // selectedDate: ''\n    }\n  },\n  computed: {\n    sessionId () {\n      return this.$route.params.sessionId\n    },\n    sessionName () {\n      let sessionId = this.sessionId\n      let user = null\n      if (/^p2p-/.test(sessionId)) {\n        user = sessionId.replace(/^p2p-/, '')\n        if (user === this.$store.state.userUID) {\n          return '我的手机'\n        } else if (this.isRobot) {\n          return this.robotInfos[user].nick || user\n        } else {\n          let userInfo = this.userInfos[user] || {}\n          return util.getFriendAlias(userInfo)\n        }\n      } else if (/^team-/.test(sessionId)) {\n        return '历史记录'\n      }\n    },\n    // 判断是否是机器人\n    isRobot () {\n      let sessionId = this.sessionId\n      let user = null\n      if (/^p2p-/.test(sessionId)) {\n        user = sessionId.replace(/^p2p-/, '')\n        if (this.robotInfos[user]) {\n          return true\n        }\n      }\n      return false\n    },\n    myInfo () {\n      return this.$store.state.myInfo\n    },\n    userInfos () {\n      return this.$store.state.userInfos\n    },\n    msglist () {\n      let msgs = this.$store.state.currSessionMsgs\n      return msgs\n    },\n    robotInfos () {\n      return this.$store.state.robotInfos\n    },\n    scene () {\n      return util.parseSession(this.sessionId).scene\n    },\n    to () {\n      return util.parseSession(this.sessionId).to\n    },\n    canLoadMore () {\n      return !this.$store.state.noMoreHistoryMsgs\n    }\n  },\n  methods: {\n    getHistoryMsgs () {\n      if (this.canLoadMore) {\n        this.$store.dispatch('getHistoryMsgs', {\n          scene: this.scene,\n          to: this.to\n        })\n      }\n    },\n    loadMore () {\n      if (pageUtil.getChatListScroll() <= 5) {\n        this.getHistoryMsgs()\n      }\n    },\n    onClickBack: function () {\n      // location.href = `#/chat/${this.sessionId}`\n      window.history.go(-1)\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/old/ChatHistory.vue","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \"\\n.p-chat-history .m-chat-main[data-v-13013b22] {\\n    padding: 0;\\n}\\n\", \"\", {\"version\":3,\"sources\":[\"/Users/wangxudong/me/sayabc/vue-im-web-demo/src/pages/old/ChatHistory.vue\"],\"names\":[],\"mappings\":\";AA0IE;IACE,WAAW;CACZ\",\"file\":\"ChatHistory.vue\",\"sourcesContent\":[\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n.p-chat-history {\\n  .m-chat-main {\\n    padding: 0;\\n  }\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css-loader?sourceMap!./~/vue-loader/lib/style-compiler?{\"id\":\"data-v-13013b22\",\"scoped\":true,\"hasInlineConfig\":true}!./~/vux-loader/src/style-loader.js!./~/vue-loader/lib/selector.js?type=styles&index=0!./src/pages/old/ChatHistory.vue\n// module id = 487\n// module chunks = 20","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"g-inherit m-article p-chat-history\"\n  }, [_c('x-header', {\n    staticClass: \"m-tab\",\n    attrs: {\n      \"left-options\": _vm.leftBtnOptions\n    },\n    on: {\n      \"on-click-back\": _vm.onClickBack\n    }\n  }, [_c('h1', {\n    staticClass: \"m-tab-top\"\n  }, [_vm._v(_vm._s(_vm.sessionName))]), _vm._v(\" \"), _c('a', {\n    attrs: {\n      \"slot\": \"left\"\n    },\n    slot: \"left\"\n  })]), _vm._v(\" \"), _c('div', {\n    staticClass: \"m-chat-main\"\n  }, [_c('chat-list', {\n    directives: [{\n      name: \"touch\",\n      rawName: \"v-touch:swipedown\",\n      value: (_vm.loadMore),\n      expression: \"loadMore\",\n      arg: \"swipedown\"\n    }],\n    ref: \"chatlist\",\n    attrs: {\n      \"type\": \"session\",\n      \"canLoadMore\": _vm.canLoadMore,\n      \"msglist\": _vm.msglist,\n      \"userInfos\": _vm.userInfos,\n      \"myInfo\": _vm.myInfo,\n      \"isHistory\": true\n    }\n  })], 1)], 1)\n},staticRenderFns: []}\nmodule.exports.render._withStripped = true\nif (module.hot) {\n  module.hot.accept()\n  if (module.hot.data) {\n     require(\"vue-hot-reload-api\").rerender(\"data-v-13013b22\", module.exports)\n  }\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-13013b22\"}!./~/vux-loader/src/before-template-compiler-loader.js!./~/vux-loader/src/template-loader.js!./~/vue-loader/lib/selector.js?type=template&index=0!./src/pages/old/ChatHistory.vue\n// module id = 512\n// module chunks = 20","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js?sourceMap!../../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"id\\\":\\\"data-v-13013b22\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":true}!../../../node_modules/vux-loader/src/style-loader.js!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./ChatHistory.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\")(\"7519d68c\", content, false);\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../node_modules/css-loader/index.js?sourceMap!../../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"id\\\":\\\"data-v-13013b22\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":true}!../../../node_modules/vux-loader/src/style-loader.js!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./ChatHistory.vue\", function() {\n     var newContent = require(\"!!../../../node_modules/css-loader/index.js?sourceMap!../../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"id\\\":\\\"data-v-13013b22\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":true}!../../../node_modules/vux-loader/src/style-loader.js!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./ChatHistory.vue\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-style-loader!./~/css-loader?sourceMap!./~/vue-loader/lib/style-compiler?{\"id\":\"data-v-13013b22\",\"scoped\":true,\"hasInlineConfig\":true}!./~/vux-loader/src/style-loader.js!./~/vue-loader/lib/selector.js?type=styles&index=0!./src/pages/old/ChatHistory.vue\n// module id = 538\n// module chunks = 20"],"sourceRoot":""}